<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <!-- https://electronjs.org/docs/tutorial/security#csp-meta-tag -->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script>window.$ = window.jQuery = require('./node_modules/jquery/dist/jquery.min.js');</script>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css" crossorigin=" anonymous">
    <!-- <link rel="stylesheet" href="node_modules/bootstrap" crossorigin=" anonymous"> -->
    <script
        src="node_modules/popper.js/dist/umd/popper.min.js">require(node_modules / popper.js / dist / umd / popper.min.js)</script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="./utils/date-utils.js"></script>
    <script src="./utils/item-utils.js"></script>
    <script src="./TodayController.js"></script>
    <script src="./ScheduledController.js"></script>
    <script src="./TasksController.js"></script>
    <link rel="stylesheet" href="index.css">
    <style type="text/css">
        a:link {
            text-decoration: none;
        }

        a:active {
            text-decoration: none
        }

        a:hover {
            text-decoration: none;
        }

        a:visited {
            text-decoration: none;
        }
    </style>
</head>

<body>
    <div class="display-flex">
        <div class="div-sidebar">
            <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical"
                style="width: 280px;">
                <a class="item-sidebar active" id="v-pills-today-tab" data-toggle="pill" href="#v-pills-today"
                    role="tab" aria-controls="v-pills-today" aria-selected="true">
                    Today
                </a>
                <a class="item-sidebar" id="v-pills-scheduled-tab" data-toggle="pill" href="#v-pills-scheduled"
                    role="tab" aria-controls="v-pills-scheduled" aria-selected="false">
                    Scheduled
                </a>
                <a class="item-sidebar" id="v-pills-completed-tab" data-toggle="pill" href="#v-pills-completed"
                    role="tab" aria-controls="v-pills-completed" aria-selected="false">
                    Completed
                </a>
                <a class="item-sidebar" id="v-pills-tasks-tab" data-toggle="pill" href="#v-pills-tasks" role="tab"
                    aria-controls="v-pills-tasks" aria-selected="false">
                    Tasks
                </a>
                <a class="item-sidebar" id="v-pills-about-tab" data-toggle="pill" href="#v-pills-about" role="tab"
                    aria-controls="v-pills-about" aria-selected="false">
                    About
                </a>
            </div>
        </div>
        <div class="div-content noselect">
            <div class="tab-content" id="v-pills-tabContent" style="flex-grow: 1">
                <div class="tab-pane fade show active" id="v-pills-today" role="tabpanel"
                    aria-labelledby="v-pills-today-tab">
                    <div style="display: flex; flex-direction: row;">
                        <div class="page">
                            <div id="content-head">
                                <div class="head-title">Today</div>
                                <div class="head-date">2020年8月16日 星期日</div>
                            </div>

                            <div id="table-filter" style="margin-right: 16px; height: 48px;">
                                <div class="dropdown" id="myDropdown"
                                    style="float:right; margin-top: 16px; margin-bottom: 8px;">
                                    <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false" onclick="getTypes()">
                                        全部
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-right" id="today-filter"
                                        aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="javascript:onClickDropdown('male')">Male</a>
                                        <a class="dropdown-item" href="javascript:onClickDropdown('female')">Female</a>
                                    </div>
                                </div>
                            </div>

                            <div class="table-area noselect" id="today-list">
                                <div class="div-list-item" onclick="chooseItem('yes')">
                                    <img src="./res/radio-false.svg" style="align-items: center;"
                                        onclick="finishTodayItem('choose'); event.cancelBubble = true">
                                    <p style="margin-left: 16px; height: 45px; line-height: 45px;">
                                        测试项目
                                        <span class="badge badge-type">英语</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="div-details noselect" id="today-details">
                            <p class="detail-name">
                                微积分第一讲极限与极限定义
                                <span class="badge badge-type">英语</span>
                                <span class="badge badge-status">首次学习</span>
                            </p>
                            <div class="divider"></div>
                            <div class="detail-content">
                                <div class="detail-block">
                                    <div class="detail-item">
                                        计划完成时间：今天
                                    </div>
                                    <div class="divider"></div>
                                    <div class="detail-item">
                                        计划完成时间：今天
                                    </div>
                                    <div class="divider"></div>
                                    <div class="detail-item">
                                        计划完成时间：今天
                                    </div>
                                </div>
                            </div>
                            <div class="divider"></div>
                            <div class="detail-foot">
                                <img src="./res/close.svg" style="margin: 12px;" onclick="hideTodayItemDetails()">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="v-pills-scheduled" role="tabpanel"
                    aria-labelledby="v-pills-scheduled-tab">
                    <div style="display: flex; flex-direction: row;">
                        <div class="page">
                            <div id="content-head">
                                <div class="head-title">Scheduled</div>
                            </div>

                            <div id="table-filter" style="margin-left: 16px; margin-right: 16px; height: 48px;">
                                <button type="button" class="btn btn-secondary btn-sm"
                                    style="float:left; margin-top: 16px; margin-bottom: 8px;"
                                    onclick="loadAddScheduledDetails(db)">添加</button>
                                <div class="dropdown" id="myDropdown"
                                    style="float:right; margin-top: 16px; margin-bottom: 8px;">
                                    <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        全部
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-right" id="scheduled-filter"
                                        aria-labelledby="dropdownMenuButton">
                                    </div>
                                </div>
                            </div>

                            <div class="table-area noselect" id="scheduled-list">
                                <div class="div-list-item" onclick="loadScheduledItemDetails(0)">
                                    <p style="margin-left: 16px; height: 45px; line-height: 45px;">
                                        测试项目
                                        <span class="badge badge-type">英语</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="div-details noselect" id="scheduled-details">
                            <p class="detail-name" id="scheduled-details-title"></p>
                            <div class="divider"></div>
                            <div class="detail-content" id="scheduled-detail-content">
                                <form style="margin: 8px;">

                                    <div class="form-group">
                                        <label for="add-scheduled-choose-type">类型</label>
                                        <select class="form-control" id="add-scheduled-choose-type">
                                            <option value=${type.id}
                                                onclick="loadAddScheduledNamesByType(db, ${type.id})">${type.name}
                                            </option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="add-scheduled-choose-task">任务</label>
                                        <select class="form-control" id="add-scheduled-choose-task">
                                            <option value=${task.id}>${task.name}</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="add-scheduled-status">状态</label>
                                        <select disabled class="form-control" id="add-scheduled-choose-task">
                                            <option value=${task.status}>${getStatusById(task.status)}</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="dtp_input1" class="col-md-2 control-label">计划日期</label>
                                        <div class="input-group date form_datetime col-md-5"
                                            data-date="1979-09-16" data-date-format="yyyy MM dd"
                                            data-link-field="dtp_input1">
                                            <input class="form-control" size="16" type="text" value="" readonly>
                                            <span class="input-group-addon"><span
                                                    class="glyphicon glyphicon-remove"></span></span>
                                            <span class="input-group-addon"><span
                                                    class="glyphicon glyphicon-th"></span></span>
                                        </div>
                                        <input type="hidden" id="dtp_input1" value="" /><br />
                                    </div>

                                    <div class="form-group">
                                        <label for="add-scheduled-typein-name">Task name</label>
                                        <input class="form-control" type="text" id="add-scheduled-typein-name"
                                            placeholder="Task name">
                                    </div>
                                    <button type="button" class="btn btn-primary"
                                        onclick="commitAddScheduledDetails(db)">提交</button>
                                </form>
                            </div>
                            <div class="divider"></div>
                            <div class="detail-foot">
                                <img src="./res/close.svg" style="margin: 12px;" onclick="hidescheduledItemDetails()">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="v-pills-completed" role="tabpanel"
                    aria-labelledby="v-pills-completed-tab">

                </div>
                <div class="tab-pane fade" id="v-pills-tasks" role="tabpanel" aria-labelledby="v-pills-tasks-tab">
                    <div style="display: flex; flex-direction: row;">
                        <div class="page">
                            <div id="content-head">
                                <div class="head-title">Tasks</div>
                            </div>

                            <div id="table-filter" style="margin-left: 16px; margin-right: 16px; height: 48px;">
                                <button type="button" class="btn btn-secondary btn-sm"
                                    style="float:left; margin-top: 16px; margin-bottom: 8px;"
                                    onclick="loadAddTaskDetails(db)">添加</button>
                                <div class="dropdown" id="myDropdown"
                                    style="float:right; margin-top: 16px; margin-bottom: 8px;">
                                    <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        全部
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-right" id="tasks-filter"
                                        aria-labelledby="dropdownMenuButton">
                                    </div>
                                </div>
                                <button type="button" class="btn btn-secondary btn-sm"
                                    style="float:right; margin-top: 16px; margin-bottom: 8px; margin-right: 8px;"
                                    onclick="loadAddTypeDetails(db)">编辑类型</button>
                            </div>

                            <div class="table-area noselect" id="tasks-list">
                                <div class="div-list-item" onclick="loadTaskItemDetails(0)">
                                    <p style="margin-left: 16px; height: 45px; line-height: 45px;">
                                        测试项目
                                        <span class="badge badge-type">英语</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="div-details noselect" id="task-details" style="display: none;">
                            <p class="detail-name" id="task-details-title"></p>
                            <div class="divider"></div>
                            <div class="detail-content" id="task-detail-content"></div>
                            <div class="divider"></div>
                            <div class="detail-foot">
                                <img src="./res/close.svg" style="margin: 12px;" onclick="hideTaskItemDetails()">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="v-pills-about" role="tabpanel" aria-labelledby="v-pills-about-tab">

                </div>
            </div>
        </div>

    </div>
</body>

<script src="index.js"></script>
<script>
    const DBManager = require('./DatabaseManager')
    const db = new DBManager('MemoryDB')

    initTodayPage(db)
    // db.addTypes('数学')
    // db.addTypes('英语')
    // db.queryType(1, function (myType) {
    //     console.log(myType)
    // })
    // db.addTask('微积分第一章数列部分', '数学', 0, function(myTask) {
    //     alert("My types: " + JSON.stringify(myTask));
    // })

    getTypes()

    function chooseItem(str) {
        console.log(str)
        $('#today-details').css("display", "")
    }

    function finishToday(str) {
        console.log(str)
    }

    function hideDetails() {
        $('#today-details').css("display", "none")
    }

    function onClickDropdown(str) {
        console.log(str)
        $('#dropdownMenuButton').html(str)
    }

    function getTypes() {
        db.getAllTypes(function (myTypes) {
            filterHtml = `<a class="dropdown-item" href="javascript:onClickDropdown('全部')">全部</a>`
            for (i = 0; i < myTypes.length; i++) {
                filterHtml += `<a class="dropdown-item" href="javascript:onClickDropdown('${myTypes[i].name}')">${myTypes[i].name}</a>`
            }
            $('#today-filter').html(filterHtml)
        })
    }

    function getTypeNameById(id) {
        db.queryType(id, function (id) {

        })
    }

    $('#v-pills-today-tab').click({ str: 'today', db: db }, testFun);
    $('#v-pills-scheduled-tab').click({ str: 'scheduled', db: db }, testFun);
    $('#v-pills-completed-tab').click({ str: 'completed', db: db }, testFun);
    $('#v-pills-tasks-tab').click({ str: 'tasks', db: db }, testFun);
    $('#v-pills-about-tab').click({ str: 'about', db: db }, testFun);

    $('.form_datetime').datetimepicker({
        weekStart: 0, //一周从哪一天开始
        todayBtn:  1, //
        autoclose: 1,
        todayHighlight: 1,
        startView: 2,
        forceParse: 0,
        showMeridian: 1
    });
</script>

</html>